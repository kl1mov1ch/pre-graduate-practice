<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–¶–ü –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏ –ü—Ä–æ–≤–µ—Ä–∫–∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <style>
        body { background-color: #f8f9fa; }
        .card { border-radius: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); padding: 20px; background: #fff; }
        .result-box { background: #e9ecef; padding: 10px; border-radius: 10px; word-wrap: break-word; }
        .form-label { font-weight: 500; }
        .form-control, .form-select { border-radius: 10px; padding: 10px; }
    </style>
</head>
<body class="bg-light">
<div class="container py-5">
    <div class="card shadow p-4">
        <h1 class="text-center mb-4">üîê –≠–¶–ü –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏ –ü—Ä–æ–≤–µ—Ä–∫–∞</h1>
        <form id="edsForm">
            <div class="mb-3">
                <label class="form-label">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç:</label>
                <textarea class="form-control" id="text" name="text" rows="3" required></textarea>
            </div>
            <div class="mb-3">
                <label class="form-label">–ó–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á (–¥–ª—è –ø–æ–¥–ø–∏—Å–∏):</label>
                <textarea class="form-control" id="privateKey" name="privateKey" rows="3"></textarea>
            </div>
            <div class="mb-3">
                <label class="form-label">–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏):</label>
                <textarea class="form-control" id="publicKey" name="publicKey" rows="3"></textarea>
            </div>
            <button type="button" class="btn btn-primary w-100" id="signButton">‚úç –ü–æ–¥–ø–∏—Å–∞—Ç—å</button>
            <button type="button" class="btn btn-success w-100 mt-2" id="verifyButton">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å</button>
            <button type="button" class="btn btn-warning w-100 mt-2" id="encryptButton">üîí –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
            <button type="button" class="btn btn-danger w-100 mt-2" id="decryptButton">üîì –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
        </form>
        <div class="mt-4">
            <h5>üìú –†–µ–∑—É–ª—å—Ç–∞—Ç:</h5>
            <div class="result-box">
                <strong>–ü–æ–¥–ø–∏—Å—å:</strong> <span id="signatureResult" class="text-success"></span>
            </div>
            <div class="result-box mt-2">
                <strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏:</strong> <span id="verificationResult" class="text-info"></span>
            </div>
            <div class="result-box mt-2">
                <strong>–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:</strong> <span id="encryptedResult" class="text-warning"></span>
            </div>
            <div class="result-box mt-2">
                <strong>–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:</strong> <span id="decryptedResult" class="text-danger"></span>
            </div>
        </div>
    </div>
</div>
<script>
    window.signText = async function() {
        const text = document.getElementById('text').value;
        const privateKey = document.getElementById('privateKey').value;
        if (!text || !privateKey) {
            alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á');
            return;
        }
        try {
            const response = await fetch('/eds-calculation', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, privateKey })
            });
            const result = await response.json();
            if (response.ok) {
                document.getElementById('signatureResult').innerText = result.signature;
            } else {
                alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
        } catch (error) {
            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ' + error.message);
        }
    };

    window.verifySignature = async function() {
        const text = document.getElementById('text').value;
        const signature = document.getElementById('signatureResult').innerText;
        const publicKey = document.getElementById('publicKey').value;
        if (!text || !signature || !publicKey) {
            alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç, –ø–æ–¥–ø–∏—Å—å –∏ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á!');
            return;
        }
        try {
            const response = await fetch('/eds-verification', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, signature, publicKey })
            });
            const result = await response.json();
            document.getElementById('verificationResult').innerText = result.isVerified ? '‚úÖ –ü–æ–¥–ø–∏—Å—å –≤–µ—Ä–Ω–∞' : '‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç';
        } catch (error) {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–ø–∏—Å–∏: ' + error.message);
        }
    };

    window.encryptText = async function() {
        const text = document.getElementById('text').value;
        const privateKey = document.getElementById('privateKey').value;
        if (!text || !privateKey) {
            alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á');
            return;
        }
        try {
            const response = await fetch('/eds-encrypt', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, privateKey })
            });
            const result = await response.json();
            if (response.ok) {
                document.getElementById('encryptedResult').innerText = result.encrypted;
            } else {
                alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
        } catch (error) {
            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ' + error.message);
        }
    };

    window.decryptText = async function() {
        const encryptedText = document.getElementById('encryptedResult').innerText;
        const publicKey = document.getElementById('publicKey').value;
        if (!encryptedText || !publicKey) {
            alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á');
            return;
        }
        try {
            const response = await fetch('/eds-decrypt', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ encryptedText, publicKey })
            });
            const result = await response.json();
            if (response.ok) {
                document.getElementById('decryptedResult').innerText = result.decrypted;
            } else {
                alert('–û—à–∏–±–∫–∞: ' + result.error);
            }
        } catch (error) {
            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ' + error.message);
        }
    };

    document.getElementById('signButton').addEventListener('click', signText);
    document.getElementById('verifyButton').addEventListener('click', verifySignature);
    document.getElementById('encryptButton').addEventListener('click', encryptText);
    document.getElementById('decryptButton').addEventListener('click', decryptText);
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>